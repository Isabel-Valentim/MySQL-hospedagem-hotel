-- DEFINIÇÃO

DROP DATABASE IF EXISTS CADASTRO_RESERVA_HOSPEDAGEM;
CREATE DATABASE CADASTRO_RESERVA_HOSPEDAGEM;
USE CADASTRO_RESERVA_HOSPEDAGEM;

CREATE TABLE PESSOAS (
    CPF_CCG_PESSOAS BIGINT PRIMARY KEY,
    NOME_PESSOAS VARCHAR(50),
    TELEFONE_PESSOAS BIGINT);

CREATE TABLE CATEGORIAS_QUARTOS (
    ID_CAT_QUARTOS INT PRIMARY KEY UNIQUE,
    NOME_QUARTO VARCHAR(50),
    DESCRICAO VARCHAR(100),
    NUM_QUARTOS INT,
    NUM_BANHEIROS INT,
    VALOR_DIARIA FLOAT);

CREATE TABLE QUARTOS (
    ID_QUARTOS INT PRIMARY KEY,
    NUMERO_QUARTO INT,
    ANDAR INT,
    ID_CAT_QUARTOS INT,
    foreign key(ID_CAT_QUARTOS) references CATEGORIAS_QUARTOS(ID_CAT_QUARTOS));

CREATE TABLE RESERVAS (
    ID_RESERVA INT PRIMARY KEY UNIQUE,
    DATA_INICIO_RESERVA DATETIME,
    DATA_FIM_RESERVA DATETIME,
    STATUS_RESERVA VARCHAR(50),
    CPF_CCG_PESSOAS BIGINT, 
    ID_CAT_QUARTOS INT,
    foreign key(CPF_CCG_PESSOAS) references PESSOAS(CPF_CCG_PESSOAS),
    foreign key(ID_CAT_QUARTOS) references CATEGORIAS_QUARTOS(ID_CAT_QUARTOS));

CREATE TABLE HOSPEDES (
    CPF_CCG_HOSPEDES BIGINT PRIMARY KEY,
    RG_HOSPEDES BIGINT,
    NOME_HOSPEDES VARCHAR(50),
    TELEFONE_HOSPEDES BIGINT,
    EMAIL_HOSPEDES VARCHAR(50));

CREATE TABLE CONSUMO_PRODUTOS_SERVICOS (
    ID_CONSUMOS INT PRIMARY KEY,
    NOME_CONSUMO VARCHAR(50),
    PRECO FLOAT,
    UNIQUE (ID_CONSUMOS, NOME_CONSUMO));

CREATE TABLE ITENS_CONSUMO (
    ID_ITENS_CONSUMO INT PRIMARY KEY,
    DATA_CONSUMO DATETIME,
    VALOR_PAGO FLOAT,
    QUANTIDADE INT,
    ID_CONSUMOS INT,
    foreign key(ID_CONSUMOS) references CONSUMO_PRODUTOS_SERVICOS(ID_CONSUMOS));

CREATE TABLE HOSPEDAGEM (
    ID_HOSPEDAGEM INT PRIMARY KEY,
    DATA_INICIO_HOSPEDAGEM DATETIME,
    DATA_FIM_HOSPEDAGEM DATETIME,
    STATUS_HOSPEDAGEM VARCHAR(50),
    VALOR_HOSPEDAGEM FLOAT,
    ID_ITENS_CONSUMO INT,
    CPF_CCG_HOSPEDES BIGINT,
    foreign key(ID_ITENS_CONSUMO) references ITENS_CONSUMO(ID_ITENS_CONSUMO),
    foreign key(CPF_CCG_HOSPEDES) references HOSPEDES(CPF_CCG_HOSPEDES));

-- POPULAÇÃO
 
INSERT INTO PESSOAS (CPF_CCG_PESSOAS, NOME_PESSOAS, TELEFONE_PESSOAS)
VALUES
    (12345678901, 'João Silva', 987654321),
    (23456789012, 'Maria Santos', 876543210),
    (34567890123, 'Pedro Oliveira', 765432109),
    (45678901234, 'Ana Costa', 654321098),
    (56789012345, 'Lucas Pereira', 543210987),
    (67890123456, 'Juliana Ferreira', 432109876),
    (78901234567, 'Fernando Almeida', 321098765),
    (89012345678, 'Carolina Rodrigues', 210987654),
    (90123456789, 'Rafael Souza', 109876543),
    (91234567890, 'Mariana Gomes', 198765432);
    

INSERT INTO HOSPEDES (CPF_CCG_HOSPEDES, RG_HOSPEDES, NOME_HOSPEDES, TELEFONE_HOSPEDES, EMAIL_HOSPEDES)
VALUES
    (12345678901, 1234567, 'João Silva', 987654321, 'hospede1@example.com'),
    (23456789012, 2345678, 'Maria Santos', 876543210, 'hospede2@example.com'),
    (34567890123, 3456789, 'Pedro Oliveira', 765432109, 'hospede3@example.com'),
    (45678901234, 4567890, 'Ana Costa', 654321098, 'hospede4@example.com'),
    (56789012345, 5678901, 'Lucas Pereira', 543210987, 'hospede5@example.com'),
    (67890123456, 6789012, 'Juliana Ferreira', 432109876, 'hospede6@example.com'),
    (78901234567, 7890123, 'Fernando Almeida', 321098765, 'hospede7@example.com'),
    (89012345678, 8901234, 'Carolina Rodrigues', 210987654, 'hospede8@example.com'),
    (90123456789, 9012345, 'Rafael Souza', 109876543, 'hospede9@example.com'),
    (10101010101, 2226667, 'Anitta', 198765432, 'hospede10@example.com');
    
INSERT INTO CATEGORIAS_QUARTOS (ID_CAT_QUARTOS, NOME_QUARTO, DESCRICAO, NUM_QUARTOS, NUM_BANHEIROS, VALOR_DIARIA)
VALUES
    (1, 'Quarto Luxo', 'Quarto de luxo com vista para o mar', 10, 2, 199.99),
    (2, 'Quarto Executivo', 'Quarto executivo com vista para a cidade', 20, 1, 299.99),
    (3, 'Quarto Padrão', 'Quarto padrão com decoração simples', 30, 1, 399.99),
    (4, 'Suíte Presidencial', 'Suíte presidencial com sala de estar e jacuzzi', 5, 3, 499.99),
    (5, 'Quarto Família', 'Quarto amplo para famílias', 15, 2, 599.99);

INSERT INTO QUARTOS (ID_QUARTOS, NUMERO_QUARTO, ANDAR, ID_CAT_QUARTOS)
VALUES
    (1, 101, 1, 1),
    (2, 102, 1, 1),
    (3, 201, 2, 2),
    (4, 202, 2, 2),
    (5, 301, 3, 3),
    (6, 302, 3, 3),
    (7, 401, 4, 4),
    (8, 402, 4, 4),
    (9, 501, 5, 5),
    (10, 502, 5, 5),
    (11, 601, 6, 5);

INSERT INTO CONSUMO_PRODUTOS_SERVICOS (ID_CONSUMOS, NOME_CONSUMO, PRECO)
VALUES
    (1, 'Refeição', 50.00),
    (2, 'Serviço de quarto', 30.00),
    (3, 'Estacionamento', 20.00),
    (4, 'Lavanderia', 40.00),
    (5, 'Minibar', 10.00);

INSERT INTO ITENS_CONSUMO (ID_ITENS_CONSUMO, DATA_CONSUMO, VALOR_PAGO, QUANTIDADE, ID_CONSUMOS)
VALUES
    (1, '2023-06-11', 100.00, 2, 1),
    (2, '2023-07-10', 60.00, 2, 2),
    (3, '2023-08-15', 40.00, 1, 4),
    (4, '2023-09-05', 20.00, 1, 3),
    (5, '2023-10-20', 30.00, 3, 5),
    (6, '2023-06-15', 10.00, 3, 5),
    (7, '2023-07-15', 10.00, 3, 5),
    (8, '2023-08-05', 50.00, 3, 5),
    (9, '2023-09-20', 30.00, 3, 5),
    (10, '2023-10-10', 30.00, 3, 5),
    (11, '2023-10-10', 30.00, 3, 5);
   
INSERT INTO HOSPEDAGEM (ID_HOSPEDAGEM, DATA_INICIO_HOSPEDAGEM, DATA_FIM_HOSPEDAGEM, STATUS_HOSPEDAGEM, VALOR_HOSPEDAGEM, ID_ITENS_CONSUMO, CPF_CCG_HOSPEDES)
VALUES
    (1, '2023-06-10', '2023-06-15', 'Ativa', 200.99, 1, 12345678901),
    (2, '2023-07-01', '2023-07-10', 'Encerrada', 599.99,  2, 23456789012),
    (3, '2023-08-15', '2023-08-20', 'Ativa', 300.99, 3, 34567890123),
    (4, '2023-09-05', '2023-09-10', 'Encerrada', 499.99, 4, 45678901234),
    (5, '2023-10-20', '2023-10-25', 'Ativa', 200.99, 5, 56789012345),
    (6, '2023-06-25', '2023-06-30', 'Ativa', 600.99, 6, 67890123456),
    (7, '2023-07-15', '2023-07-20', 'Encerrada', 799.99, 7, 78901234567),
    (8, '2023-08-05', '2023-08-10', 'Ativa', 399.99, 8, 89012345678),
    (9, '2023-09-20', '2023-09-25', 'Encerrada', 5667.99, 9, 90123456789),
	(10, '2023-10-10', '2023-10-15', 'Ativa', 10000.99, 11, 10101010101);

INSERT INTO RESERVAS (ID_RESERVA, DATA_INICIO_RESERVA, DATA_FIM_RESERVA, STATUS_RESERVA, CPF_CCG_PESSOAS, ID_CAT_QUARTOS)
VALUES
    (1, '2023-06-10', '2023-06-15', 'Confirmada', 12345678901, 1),
    (2, '2023-07-01', '2023-07-10', 'Confirmada', 23456789012, 2),
    (3, '2023-08-15', '2023-08-20', 'Confirmada', 34567890123, 3),
    (4, '2023-09-05', '2023-09-10', 'Confirmada', 45678901234, 4),
    (5, '2023-10-20', '2023-10-25', 'Confirmada', 56789012345, 5),
    (6, '2023-06-25', '2023-06-30', 'Confirmada', 67890123456, 1),
    (7, '2023-07-15', '2023-07-20', 'Confirmada', 78901234567, 2),
    (8, '2023-08-05', '2023-08-10', 'Confirmada', 89012345678, 3),
    (9, '2023-09-20', '2023-09-25', 'Confirmada', 90123456789, 4),
    (10, '2023-10-10', '2023-10-15', 'Cancelada', 91234567890, 5);


-- VISUALIZAR CPF, NOME E TELEFONE DOS HOSPEDES
SELECT CPF_CCG_HOSPEDES, NOME_HOSPEDES, TELEFONE_HOSPEDES FROM HOSPEDES;

-- VISUALIZAR RESERVAS CACELADAS
SELECT DATA_INICIO_RESERVA, DATA_FIM_RESERVA, STATUS_RESERVA, CPF_CCG_PESSOAS
FROM RESERVAS
WHERE STATUS_RESERVA = 'CANCELADA';

-- CRIAR NOVA TABELA DE PREÇOS DE QUARTOS PARA UMA PROMOÇÃO DE DUAS CATEGORIAS DE QUARTOS
SELECT 'VALOR PROMOCIONAL' AS 'REF', NOME_QUARTO, VALOR_DIARIA*0.5 AS 'VALOR_DIARIA' FROM CATEGORIAS_QUARTOS
WHERE NOME_QUARTO = 'Suíte Presidencial'
UNION 
SELECT 'VALOR ORIGINAL' AS 'REF', NOME_QUARTO, VALOR_DIARIA FROM CATEGORIAS_QUARTOS
WHERE NOME_QUARTO = 'Suíte Presidencial';

-- VERIFICAR PESSOAS QUE SÃO HOSPEDES MAS NÃO FIZERAM RESERVA
SELECT NOME_HOSPEDES FROM HOSPEDES
WHERE NOME_HOSPEDES NOT IN (SELECT NOME_PESSOAS FROM PESSOAS);

-- VERIFICAR O NOME DOS HOSPEDES E OS VALOR DE HOSPEDAGEM
SELECT NOME_HOSPEDES, VALOR_HOSPEDAGEM FROM HOSPEDES A
INNER JOIN HOSPEDAGEM B
ON A.CPF_CCG_HOSPEDES = B.CPF_CCG_HOSPEDES;

